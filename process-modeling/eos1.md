# EOS1

1. **Description and specifications**

EOS1 is the most basic EOS module, providing a description of one or two waters in their liquid, vapor, two-phase and supercritical states. If two waters exist, the two waters must have identical physical properties.  For such a case, two water mass balances will be set up, allowing separate tracking of the two components. For example, one could specify the water initially present in the flow system as “water1” (such as fresh water), while water being injected is specified as “water2” (such as dirty water).  When the two waters option is chosen, molecular diffusion can also be modeled by turning on the diffusion option by input at "[MODDE.3](../preparation-of-model-input/keywords-and-input-data/modde.md)".&#x20;

The specifications for EOS1 are given in Table 4. The default component number is 1 (water1). Users have the options to include second water, and as many as 5 tracers with a maximum component number of 7.  The second water can be invoked  through parameter _hBSW_ in record 3 of  keyword ""[MODDE](../preparation-of-model-input/keywords-and-input-data/modde.md)" input. Tracers are defined in the input keyword "[TRACR](../preparation-of-model-input/keywords-and-input-data/tracr.md)". They can only exist in the user specified phase. The flow system can be in liquid, vapor, two-phase or supercritical states. Different primary variables are used for different phase conditions (see Table 14).  The primary variables _Xw2_ and _Xtrn_ are optional. They are needed when only corresponding mass components exist. The primary variable selection is for facilitating the calculation of the fluid thermophysical properties. All thermophysical properties (density, specific enthalpy, viscosity) are assumed independent of the component mixture; i.e., independent of mass fractions of all the components. This approximation is applicable for problems in which the identity of different waters and tracers is distinguished by the presence of different trace constituents, which occur in concentrations low enough to not appreciably affect the thermophysical properties.

&#x20;Table 4 Summary for EOS1

<table><thead><tr><th width="190">Specification</th><th>Parameters</th></tr></thead><tbody><tr><td>Components</td><td><p>(1) Water1</p><p>(2) Water2 (optional)</p><p>(3-7) Tracer1-Tracer5 (optional)</p></td></tr><tr><td>Phase condition and its state name and index</td><td><p>(1) Gas, GAS </p><p>(2) Aqueous, AQU </p><p>(3) two-phase, AQG</p><p>(4) Supercritical, SUP </p></td></tr><tr><td>Primary variables</td><td>See <a href="../preparation-of-model-input/inputs-for-initial-conditions/eos1.md">Table 19</a></td></tr><tr><td>Optional process modeling</td><td>Molecular diffusion, Vapor pressure lowering, Wellbore simulation, Biodegradation reactions, and non-isothermal simulation.</td></tr></tbody></table>

The initial phase conditions can be figured out from the value of primary variables. It is also allowed users to input phase state name as part of the initial condition.  &#x20;

The phase diagnostic procedures are as follows. For single-phase points the temperature is monitored, and the corresponding saturation pressure is compared with actual fluid pressure P. For a vapor (liquid) point to remain vapor (liquid), we require that P < Psat (P > Psat); if this requirement is violated, a transition to two-phase conditions takes place. The primary variables are then switched, and these are initialized as Pg = Psat(T), Sg = 0.999999 if the point was in the vapor region, and Sg = 0.000001 if it was in the liquid region. For two-phase points Sg is monitored; we require that 0 < Sg < 1 for a point to remain two-phase. If Sg < 0 this indicates disappearance of the gas phase; the primary variables are then switched, and the point is initialized as single-phase liquid, with T taken from the last Newton-Raphson iteration, and P = 1.000001 × Psat(T). For Sg > 1 the liquid phase disappears; again the primary variables are switched, and the point is initialized as single-phase vapor, with T taken from the last Newton-Raphson iteration, and P = 0.999999 × Psat(T). Note that in these phase transitions we preserve temperature rather than pressure from the last iteration. This is preferable because in most flow problems temperature tends to be more slowly varying than pressure. The diagnostic procedures for supercritical state is based on the system temperature, pressure condition, and water density. The regions and the phase condition are showing in Figure 14. Table 5 shows the conditions for phase transition.

<figure><img src="../.gitbook/assets/image (46).png" alt=""><figcaption><p>Figure 14. The regions of phase condition used in EOS1 </p></figcaption></figure>

Table 5. Phase transition conditions for supercritical state

<table><thead><tr><th width="229">Original phase condition</th><th width="187">New phase condition</th><th>Phase transition Criteria</th></tr></thead><tbody><tr><td>Gas</td><td>Supercritical</td><td>T>350 <span class="math">^oC</span>, P>Pb</td></tr><tr><td>Liquid</td><td>Supercritical</td><td><p>(1) T>Tcrit,  P>Pb, or </p><p>(2) 350<span class="math">^oC</span>&#x3C;T&#x3C;Tcrit and P>Psat</p></td></tr><tr><td>Two-phase</td><td>Supercritical</td><td><p>T>350 <span class="math">^oC</span> , and </p><p>(1) P>Pcrit  or </p><p>(2) P<span class="math">\le</span>Pcrit and sg <span class="math">\le</span>0 or sg <span class="math">\ge</span>1.0</p></td></tr><tr><td>Supercritical</td><td>Gas</td><td>T <span class="math">\le</span>350 <span class="math">^oC</span>, density&#x3C;113.6127 kg/m3</td></tr><tr><td>Supercritical</td><td>Two-phase</td><td>T <span class="math">\le</span>350 <span class="math">^oC</span>, density>113.6127 kg/m3 and density&#x3C;574.67 kg/m3</td></tr><tr><td>Supercritical</td><td>Liquid</td><td>T <span class="math">\le</span>350 <span class="math">^oC</span>, and density <span class="math">\ge</span>574.67 kg/m3</td></tr></tbody></table>

In the table 5, Pcrit and Tcrit are critical pressure and temperature respectively, Pb is the pressure on the boundary between regions Gas and Super Critical at given a temperature,  and Psat is saturation pressure.

2. **Thermodynamic Formulation**

&#x20;All water properties (density, specific enthalpy, viscosity, saturated vapor pressure) are calculated either from the steam table equations as given by IFC-67 (the International Formulation Committee, 1967) or by the IAPWS-IF97 (International Association for the Properties of Water and Steam, 2007) and the IAPWS-95 (International Association for the Properties of Water and Steam, 2002).&#x20;

For water in subcritical condition, the IFC-67 equations are sufficient. The formulation includes subregion 1 (subcooled water below T = 350 ˚C), subregion 2 (superheated steam), and subregion 4 (saturation line up to T = 350 ˚C). In these regions, density and internal energy are represented within experimental accuracy. Viscosity of liquid water and steam are represented to within 2.5 % by correlations given in the same reference. For details of the formulation, its accuracy and range of validity, refer to the original publication. Vapor pressure lowering from capillary and adsorption effects is considered; thus, in two-phase conditions vapor pressure is equal to saturated vapor pressure of bulk liquid. TOUGH4 also allows using IAPWS-IF97 or IAPWS-95 for the calculation.&#x20;

The IAPWS-95 formulation currently serves as the international standard for water’s thermodynamic properties. The operational range for IAPWS-95 has been tested and accepted by the International Association for the Properties of Water and Steam (IAPWS) for up to 1000°C and 100 MPa. The IAPWS-IF97 formulation is a separate, faster formulation based on IAPWS-95, and maintained for industrial use. IAPWS-IF97 is accepted by IAPWS for up to 800°C and 100 MPa, and for up to 2000°C for pressure at or below 50 MPa. Both the IAPWS-95 and IAPWS-IF97 formulations can be extrapolated to extremely high temperatures and densities above the operational limit tested by IAPWS (Magnusdottir and Finsterle, 2015; Yamazaki and Muto, 2004). Three options to select the thermodynamic formulation are available in EOS1: (1) IFC-67, which is only valid for subcritical conditions, (2) IAPWS-IF97, or (3) IAPWS-95 for temperature above or equal to 800°C, and IAPWS-IF97 for temperature below 800°C. For the last option, IAPWS-95 is not used for the whole temperature range because IAPWS-IF97 is significantly faster; IAPWS-IF97 has been accepted by IAPWS to accurately approximate IAPWS-95 within 800°C and 100 MPa.

The IAPWS-IF97 formulation is given in terms of regions nominally defined as liquid, vapor, supercritical, two-phase, and high temperature vapor as shown in Figure 14. Regions 1, 2 and 5 in Figure 14 are individually covered by a fundamental equation for the specific Gibbs free energy given in terms of pressure and temperature. Region 3 is covered by a fundamental equation for the specific Helmholtz free energy and is given in terms of density and temperature. Region 4, i.e., the saturation curve, is given by a saturation-pressure equation.  The primary variables need to be switched when a region boundary is crossed. An iterative process is used to calculate the thermodynamic variables at the end of every time step and when a region boundary is crossed, the iteration is stopped on a boundary point between the two regions. In EOS1, that boundary point is chosen by projecting the initially calculated new state point vertically onto the boundary to preserve the new temperature. An exception has to be made as described by Croucher and O’Sullivan  (2008), because the boundary between the liquid and supercritical regions is vertical (see Figure 14). Thus, the boundary point is determined by preserving density for transitions from supercritical to liquid, and by maintaining pressure for transitions from liquid to supercritical. The boundaries of the regions for the IAPWS-IF97 formulation are chosen arbitrarily; they are different from the true phase boundaries. Thus, if the temperature and pressure is above the critical point, the corresponding region in Figure 14 might be vapor with pressure and temperature being used as primary variables, although the true phase is supercritical. The boundary between regions 1 and 3 is at 350°C, the boundary between regions 2 and 5 is at 800°C, and the boundary between regions 2 and 3 is defined by a so-called B23-equation as described by Wagner et al. (2000). It is not necessary to identify the exact location of the boundaries when using EOS1, because the initial conditions can be given in terms of pressure and temperature for all phases.  If the IAPWS-IF97 formulation is used above its operational limit, region 5 in Figure 14 is extrapolated. Region 5 can be extrapolated to high temperatures and pressures but extrapolating region 2 gives inaccurate thermodynamic properties (Magnusdottir and Finsterle, 2015a).&#x20;

The IAPWS-95 formulation is given by the fundamental equation for the specific Helmholtz free energy. The primary variables are density and temperature for the entire state space. Thus, iterative function inversions are required when using IAPWS-95 outside of the supercritical region.  Detailed procedures for density and internal energy calculation in these regions using IAPWS-95 can be found in Magnúsdóttir and Finsterle (2015b).

3. **Specific input requirements**

There is no many special input requirements for EOS1. The only optional input specifically required for EOS1 are **IE(33)** and **IE(111)**:

**IE(33)**             Performs supercritical water simulation

&#x20;              0: on.&#x20;

&#x20;              1: off, supercritical water is neglected and treated as high temperature vapor.

**IE(111)**             Selects thermodynamic formulation

&#x20;               0: IFC-67, for subcritical condition  only

&#x20;               1: IAPWS-IF97

&#x20;               2: IAPWS-IF97 for T<800 $$^oC$$; IAPW95 for T >=800 $$^oC$$;

For the input of **IE** array, user may refer to Keyword "[SELEC](../preparation-of-model-input/keywords-and-input-data/selec.md)".&#x20;

It is also allowed to use the MOP2(11) for the selection of thermodynamic formulation. IE(111) and MOP2(11) are equivalent.&#x20;
