# EOS4

1. **Description**&#x20;

EOS4 is originally an adaptation of the EOS3 module, and implements vapor pressure lowering effects. As EOS3 has also included vapor pressure lowering effects in TOUGH4, the only differences between EOS3 and EOS4 is the use of different primary variables.&#x20;

Vapor pressure $$P_v$$ is expressed by Kelvin’s equation, Eq. 7-3 (Edlefsen and Anderson, 1943); it is a function not only of temperature, but depends also on capillary pressure, which in turn is a function of saturation.&#x20;

$$P_v(T,S_l)=f_{VPL}(T,S_l)P_{sat}(T)$$                                                                                     (7-3)

where

$$f_{VPL}=exp[\dfrac{M_wP_{cl}(S_l)}{\rho_lR(T+273.15)}]$$                                                                                       (7-4)

is the vapor pressure lowering factor. $$P_{sat}$$is the saturated vapor pressure of bulk aqueous phase, _T_ is temperature, $$S_l$$ is the liquid (water) saturation, $$P_{cl}$$ is the capillary pressure (i.e., the difference between aqueous and gas phase pressures), $$M_w$$is the molecular weight of water, $$\rho_l$$ is the liquid density, and _R_ is the universal gas constant.

2. **Specifications**

A summary of EOS4 specifications and parameters is given in Table 8.  The default number of mass components is 2. Simulation can be run in isothermal or non-isothermal. The default choice of primary thermodynamic variables is (P, $$P_{air}$$, T) for single-phase, (Pg, Sg, $$P_{air}$$) for two-phase conditions, where $$P_{air}$$ is the partial pressure of air. Note that in two-phase conditions temperature is not among the primary variables. It is implicitly determined from the relationship $$P_g-P_{air}=P_v$$, with $$P_v=P_v(T,S_l)$$as given in Eq. 7-3.&#x20;

Table 8 Summary for EOS4

<table><thead><tr><th width="268">Specification</th><th>Parameters</th></tr></thead><tbody><tr><td>Components</td><td><p>(1) Water</p><p>(2) AIR</p><p>(3-7) Tracer1-Tracer5 (optional)</p></td></tr><tr><td>Phase condition and its state name and index</td><td><p>(1) Gas, GAS </p><p>(2) Aqueous, AQU </p><p>(3) two-phase, AQG</p></td></tr><tr><td>Primary variables</td><td>See <a href="../preparation-of-model-input/inputs-for-initial-conditions/eos4.md">Table 22</a></td></tr><tr><td>Optional process modeling</td><td>Molecular diffusion, Vapor pressure Lowering, Wellbore simulation, Biodegradation reactions, and non-isothermal simulation. </td></tr></tbody></table>

It would be possible to use other sets of primary variables; in particular, temperature could be used also in two-phase conditions. Test calculations for a number of examples indicated, however, that the choice (_Pg, Sg_, $$P_{air}$$) usually leads to better convergence behavior than the choice (_Pg, Sg, T_). The reason for the numerically inferior behavior of the latter set is in the air mass balance. With the variables (_Pg, Sg, T_), the amount of air present in a grid block becomes controlled by the difference between total gas pressure _Pg_ and effective vapor pressure _Pv_ (Eq. 7-3), which can be subject to very severe numerical cancellation. From the application's viewpoint, however, initialization of a flow problem with the set (_Pg, Sg, T_) may be much more physical and convenient. TOUGH4/EOS4 can [reading initial condition inputs of TOUGH3/EOS3/EOS4](../preparation-of-model-input/inputs-for-initial-conditions/eos4.md), which allows the initialization of two-phase points as (_Pg, Sg, T_); this capability can be selected by specifying MOP(19) = 1. When using MOP(19) = 1, the second primary variable upon initialization can also be relative humidity _RH_, expressed as a fraction (0 < _RH_ ≤ 1); this choice is made by entering the second primary variable as a negative number, which will serve as a flag to indicate that it means (negative of) relative humidity, and will be internally converted to saturation in the initialization phase. The conversion consists of iteratively solving Kelvin’s equation for given $$RH=f_{VPL}(T,S_l)$$for $$S_l$$.  Users need to beware that relative humidity specifications must be within the range that is feasible for the capillary pressure functions used. If maximum capillary pressures are not strong enough to accommodate a chosen value of _RH_, a diagnostic will be printed and execution will terminate. As a further convenience to users, EOS4 is also allowed to be initialized with EOS3 variables of (_P, X, T_) for single-phase, (_Pg, Sg + 10, T_) for two-phase.

Vapor pressure lowering effects raise new issues because they make it possible for a liquid phase to exist under conditions where vapor partial pressure and gas phase total pressure are less than the saturation pressure. What is the appropriate pressure at which liquid phase density, enthalpy and viscosity are to be evaluated? We believe that a physically plausible choice is to take $$P_l$$ _= max(Pg,_ $$P_{sat}$$_)_, and this has been implemented in EOS4. The implementation faces a difficulty, however, because temperature is not among the primary variables in two-phase conditions, so that  $$P_{sat}$$ is only implicitly known; moreover, vapor pressure lowering effects are functionally dependent on liquid phase density, which is also a function of temperature. This leads to a potentially unstable situation with regard to the choice of liquid phase pressure under conditions where $$P_g$$ _≈_ $$P_{sat}$$, which happens to be a common occurrence in boiling regions. In order to avoid this problem, we evaluate liquid water density in the Kelvin equation for vapor pressure lowering (Eq. 7-3) always at $$P_l=P_{sat}$$, which will be an excellent approximation due to the small compressibility of liquid water. In all accumulation and flow terms the density of liquid water is evaluated at $$P_l$$ _= max(_ $$P_g$$_,_ $$P_{sat}$$_)._ Vapor pressure lowering can be optionally suppressed by setting MOP(20) = 1.
