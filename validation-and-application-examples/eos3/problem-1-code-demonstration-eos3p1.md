# Problem 1  -  Code Demonstration (eos3p1)

This problem is from the first example in TOUGH3/EOS3 User manual. It demonstrates various initialization options and generation specifications. A number of one- and two-element subproblems are simulated which are entirely independent of each other (no flow connections between subproblems), except that being run together they all must go through the same sequence of time steps. The sub-problems perform flow and/or injection and withdrawal of water, air, and heat, with highly nonlinear phase and component (dis-)appearances that engage some subtle numerical procedures. The input file for running with the EOS3 fluid properties module is provided for download. Parameter MOP(19) in the first record of data block PARAM was set equal to 1, to permit initialization of the EOS3 module with TOUGH-style primary variables of (P, T, X) for single phase, (P, S, T) for two-phase. Data block OUTPU is used to select variables to print out, and data blocks FOFT and GOFT are used to generate time series for selected grid blocks and generation items that can be used for plotting.  The input and output files can be downloaded below.&#x20;

By comparison the simulation results to TOUGH3 corresponding results, we can find the results at element "SHO 1", "SHO 6", "SHO 7", and "SHO 8" are quite different. In all these elements, GENER has a type of "MASS" with a non-blank "_LTAB"_.  When "_LTAB" is not a_ blank,  TOUGH3 will produce water only and use user specified enthalpy for energy balance calculation.  This problem was corrected in TOUGH4 and it remains producing MASS (whatever mass is in the element). If the source/sink type in TOUGH4 input changes to "WATE" for these elements, simulation results from both codes will match very well.&#x20;

The time-stepping's are quite different between TOUGH3 and TOUGH4 simulation. This is because TOUGH4 strictly loyal to the time changes in GENER inputs, which is expected to improve accuracy of simulation results.  If TOUGH4 is forced to use the same time-stepping scheme as TOUGH3, the almost identical results can be reached.  File "INFILE\_match\_time\_steps.zip" is the input for the  same time-stepping scheme simulation (excluding the subproblems which have time-dependent source/sinks).&#x20;

**Input files**:       [input\_eosp1.zip](https://drive.google.com/file/d/1v17Ft8PxFmyaFOdqNVHFsvHqU0WrzNvS/view?usp=sharing), [INFILE\_match\_time\_steps.zip](https://drive.google.com/file/d/1ljCtfICStmz1-mQn0rn\_79cc6xQX\_wam/view?usp=sharing)

**Output Files**:  [outputs\_eosp1.zip](https://drive.google.com/file/d/1AVZHCRmRyVbOm6bkr3adUGu35uA0bDOu/view?usp=sharing)
